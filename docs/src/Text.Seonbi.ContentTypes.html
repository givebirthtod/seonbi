<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLists #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Seonbi.ContentTypes</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#ContentType"><span class="hs-identifier">ContentType</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#HtmlTransformer"><span class="hs-identifier">HtmlTransformer</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TextTransformer"><span class="hs-identifier">TextTransformer</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asCommonMarkTransformer"><span class="hs-identifier">asCommonMarkTransformer</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asHtmlTransformer"><span class="hs-identifier">asHtmlTransformer</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asHtmlTransformer%27"><span class="hs-identifier">asHtmlTransformer'</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asPlainTextTransformer"><span class="hs-identifier">asPlainTextTransformer</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asXhtmlTransformer"><span class="hs-identifier">asXhtmlTransformer</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#contentTypeFromText"><span class="hs-identifier">contentTypeFromText</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#contentTypes"><span class="hs-identifier">contentTypes</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#contentTypeText"><span class="hs-identifier">contentTypeText</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#transformWithContentType"><span class="hs-identifier">transformWithContentType</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span class="hs-cpp">

#if MIN_VERSION_base(4,13,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadFail</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadFail</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">CMark</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LT</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.Builder</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HTMLEntities.Builder</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">HTMLEntities.Decoder</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Media.Accept</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Media.MediaType</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Media.RenderHeader</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.html"><span class="hs-identifier">Text.Seonbi.Html</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html"><span class="hs-identifier">Text.Seonbi.Html.Tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#headingLevel"><span class="hs-identifier">headingLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#headingTag%27"><span class="hs-identifier">headingTag'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.TagStack.html"><span class="hs-identifier">Text.Seonbi.Html.TagStack</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TagStack</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Represents a function that transforms an 'HtmlEntity' list.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">type</span><span> </span><span id="HtmlTransformer"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#HtmlTransformer"><span class="hs-identifier hs-var">HtmlTransformer</span></a></span></span><span> </span><span id="local-6989586621679151809"><span class="annot"><a href="#local-6989586621679151809"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151809"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151809"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679151809"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | Represents a function that transforms a text.</span><span>
</span><span id="line-51"></span><span class="hs-keyword">type</span><span> </span><span id="TextTransformer"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TextTransformer"><span class="hs-identifier hs-var">TextTransformer</span></a></span></span><span> </span><span id="local-6989586621679151808"><span class="annot"><a href="#local-6989586621679151808"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151808"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151808"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LT.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679151808"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LT.Text</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- | Represents a function that transforms an 'HtmlTransformer' into</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- a 'TextTransformer'.</span><span>
</span><span id="line-56"></span><span class="hs-keyword">type</span><span> </span><span id="TransformerTransformer"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer"><span class="hs-identifier hs-var">TransformerTransformer</span></a></span></span><span> </span><span id="local-6989586621679151807"><span class="annot"><a href="#local-6989586621679151807"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151807"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151807"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#HtmlTransformer"><span class="hs-identifier hs-type">HtmlTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151807"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TextTransformer"><span class="hs-identifier hs-type">TextTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151807"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Gets a 'TransformerTransformer' that transforms 'HtmlTransformer' into</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- a 'TextTransformer' which transforms an HTML/XHTML text.</span><span>
</span><span id="line-61"></span><span id="local-6989586621679151896"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asHtmlTransformer%27"><span class="hs-identifier hs-type">asHtmlTransformer'</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151896"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151896"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">-- ^ 'True' for XHTML, and 'False' for HTML.</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer"><span class="hs-identifier hs-type">TransformerTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151896"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- ^ A 'TransformerTransformer' that transforms an 'HtmlTransformer' into</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- a 'TextTransformer' which transforms an HTML/XHTML text.</span></span><span>
</span><span id="line-68"></span><span id="asHtmlTransformer%27"><span class="annot"><span class="annottext">asHtmlTransformer' :: Bool -&gt; TransformerTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asHtmlTransformer%27"><span class="hs-identifier hs-var hs-var">asHtmlTransformer'</span></a></span></span><span> </span><span id="local-6989586621679151806"><span class="annot"><span class="annottext">xhtml :: Bool
</span><a href="#local-6989586621679151806"><span class="hs-identifier hs-var">xhtml</span></a></span></span><span> </span><span id="local-6989586621679151805"><span class="annot"><span class="annottext">transformer :: HtmlTransformer m
</span><a href="#local-6989586621679151805"><span class="hs-identifier hs-var">transformer</span></a></span></span><span> </span><span id="local-6989586621679151804"><span class="annot"><span class="annottext">htmlText :: Text
</span><a href="#local-6989586621679151804"><span class="hs-identifier hs-var">htmlText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Result [HtmlEntity]
</span><a href="Text.Seonbi.Html.Scanner.html#scanHtml"><span class="hs-identifier hs-var">scanHtml</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151804"><span class="hs-identifier hs-var">htmlText</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Done</span></span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span id="local-6989586621679151801"><span class="annot"><span class="annottext">input :: [HtmlEntity]
</span><a href="#local-6989586621679151801"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-71"></span><span>            </span><span id="local-6989586621679151800"><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151800"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HtmlTransformer m
[HtmlEntity] -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151805"><span class="hs-identifier hs-var">transformer</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151801"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-72"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; m Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m Text) -&gt; Text -&gt; m Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; Text
</span><a href="#local-6989586621679151799"><span class="hs-identifier hs-var">printHtml'</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151800"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-74"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; m Text
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;failed to parse input&quot;</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="#local-6989586621679151799"><span class="hs-identifier hs-type">printHtml'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LT.Text</span></span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679151799"><span class="annot"><span class="annottext">printHtml' :: [HtmlEntity] -&gt; Text
</span><a href="#local-6989586621679151799"><span class="hs-identifier hs-var hs-var">printHtml'</span></a></span></span><span>
</span><span id="line-78"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679151806"><span class="hs-identifier hs-var">xhtml</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; Text
</span><a href="Text.Seonbi.Html.Printer.html#printXhtml"><span class="hs-identifier hs-var">printXhtml</span></a></span><span>
</span><span id="line-79"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; Text
</span><a href="Text.Seonbi.Html.Printer.html#printHtml"><span class="hs-identifier hs-var">printHtml</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Transforms an 'HtmlTransformer' into a 'TextTransformer' which transforms</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- an HTML text.</span><span>
</span><span id="line-83"></span><span id="local-6989586621679151840"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asHtmlTransformer"><span class="hs-identifier hs-type">asHtmlTransformer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151840"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151840"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer"><span class="hs-identifier hs-type">TransformerTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151840"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-84"></span><span id="asHtmlTransformer"><span class="annot"><span class="annottext">asHtmlTransformer :: HtmlTransformer m -&gt; TextTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asHtmlTransformer"><span class="hs-identifier hs-var hs-var">asHtmlTransformer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TransformerTransformer m
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
Bool -&gt; TransformerTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asHtmlTransformer%27"><span class="hs-identifier hs-var">asHtmlTransformer'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | Transforms an 'HtmlTransformer' into a 'TextTransformer' which transforms</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- an XHTML text.</span><span>
</span><span id="line-88"></span><span id="local-6989586621679151796"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asXhtmlTransformer"><span class="hs-identifier hs-type">asXhtmlTransformer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151796"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151796"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer"><span class="hs-identifier hs-type">TransformerTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151796"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-89"></span><span id="asXhtmlTransformer"><span class="annot"><span class="annottext">asXhtmlTransformer :: HtmlTransformer m -&gt; TextTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asXhtmlTransformer"><span class="hs-identifier hs-var hs-var">asXhtmlTransformer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TransformerTransformer m
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
Bool -&gt; TransformerTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asHtmlTransformer%27"><span class="hs-identifier hs-var">asHtmlTransformer'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Transforms an 'HtmlTransformer' into a 'TextTransformer' which transforms</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- a plain text.</span><span>
</span><span id="line-93"></span><span id="local-6989586621679151795"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asPlainTextTransformer"><span class="hs-identifier hs-type">asPlainTextTransformer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151795"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151795"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer"><span class="hs-identifier hs-type">TransformerTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151795"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-94"></span><span id="asPlainTextTransformer"><span class="annot"><span class="annottext">asPlainTextTransformer :: HtmlTransformer m -&gt; TextTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asPlainTextTransformer"><span class="hs-identifier hs-var hs-var">asPlainTextTransformer</span></a></span></span><span> </span><span id="local-6989586621679151794"><span class="annot"><span class="annottext">transformer :: HtmlTransformer m
</span><a href="#local-6989586621679151794"><span class="hs-identifier hs-var">transformer</span></a></span></span><span> </span><span id="local-6989586621679151793"><span class="annot"><span class="annottext">text' :: Text
</span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">text'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679151792"><span class="annot"><span class="annottext">escaped :: Text
</span><a href="#local-6989586621679151792"><span class="hs-identifier hs-var hs-var">escaped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; Builder -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">HTMLEntities.Builder.text</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Builder) -&gt; Text -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.toStrict</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">text'</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679151788"><span class="annot"><span class="annottext">entities :: [HtmlEntity]
</span><a href="#local-6989586621679151788"><span class="hs-identifier hs-var hs-var">entities</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HtmlTagStack -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlText"><span class="hs-identifier hs-var">HtmlText</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="Text.Seonbi.Html.TagStack.html#empty"><span class="hs-identifier hs-var">TagStack.empty</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Item [HtmlEntity]) -&gt; Text -&gt; Item [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.toStrict</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151792"><span class="hs-identifier hs-var">escaped</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679151785"><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151785"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HtmlTransformer m
[HtmlEntity] -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151794"><span class="hs-identifier hs-var">transformer</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151788"><span class="hs-identifier hs-var">entities</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m Text) -&gt; Text -&gt; m Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; Text
</span><a href="Text.Seonbi.Html.Printer.html#printText"><span class="hs-identifier hs-var">printText</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151785"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | Transforms an 'HtmlTransformer' into a 'TextTransformer' which transforms</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- a CommonMark (Markdown) text.</span><span>
</span><span id="line-102"></span><span id="local-6989586621679151783"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#asCommonMarkTransformer"><span class="hs-identifier hs-type">asCommonMarkTransformer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151783"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151783"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer"><span class="hs-identifier hs-type">TransformerTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151783"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-103"></span><span id="asCommonMarkTransformer"><span class="annot"><span class="annottext">asCommonMarkTransformer :: HtmlTransformer m -&gt; TextTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asCommonMarkTransformer"><span class="hs-identifier hs-var hs-var">asCommonMarkTransformer</span></a></span></span><span> </span><span id="local-6989586621679151782"><span class="annot"><span class="annottext">transformer :: HtmlTransformer m
</span><a href="#local-6989586621679151782"><span class="hs-identifier hs-var">transformer</span></a></span></span><span> </span><span id="local-6989586621679151781"><span class="annot"><span class="annottext">input :: Text
</span><a href="#local-6989586621679151781"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679151780"><span class="annot"><span class="annottext">inputNode :: Node
</span><a href="#local-6989586621679151780"><span class="hs-identifier hs-var hs-var">inputNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CMarkOption] -&gt; Text -&gt; Node
</span><span class="hs-identifier hs-var">commonmarkToNode</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [CMarkOption]
CMarkOption
</span><span class="hs-identifier hs-var">optSourcePos</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Item [CMarkOption]
CMarkOption
</span><span class="hs-identifier hs-var">optUnsafe</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Node) -&gt; Text -&gt; Node
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-105"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.toStrict</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151781"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621679151776"><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151776"><span class="hs-identifier hs-var">inputEntities</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; Node -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTagStack -&gt; Node -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151775"><span class="hs-identifier hs-var">fromNode</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679151780"><span class="hs-identifier hs-var">inputNode</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679151774"><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151774"><span class="hs-identifier hs-var">outputEntities</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HtmlTransformer m
[HtmlEntity] -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151782"><span class="hs-identifier hs-var">transformer</span></a></span><span> </span><span class="annot"><span class="annottext">([HtmlEntity] -&gt; m [HtmlEntity]) -&gt; [HtmlEntity] -&gt; m [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [HtmlEntity]
</span><a href="Text.Seonbi.Html.TextNormalizer.html#normalizeText"><span class="hs-identifier hs-var">normalizeText</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151776"><span class="hs-identifier hs-var">inputEntities</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679151772"><span class="annot"><span class="annottext">outputNodes :: [Node]
</span><a href="#local-6989586621679151772"><span class="hs-identifier hs-var hs-var">outputNodes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [Node]
</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151774"><span class="hs-identifier hs-var">outputEntities</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679151770"><span class="annot"><span class="annottext">outputNode :: Node
</span><a href="#local-6989586621679151770"><span class="hs-identifier hs-var hs-var">outputNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679151772"><span class="hs-identifier hs-var">outputNodes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-110"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621679151769"><span class="annot"><span class="annottext">node :: Item [Node]
</span><a href="#local-6989586621679151769"><span class="hs-identifier hs-var">node</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DOCUMENT</span></span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Item [Node]
Node
</span><a href="#local-6989586621679151769"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-111"></span><span>            </span><span id="local-6989586621679151766"><span class="annot"><span class="annottext">nodes :: [Node]
</span><a href="#local-6989586621679151766"><span class="hs-identifier hs-var">nodes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; NodeType -&gt; [Node] -&gt; Node
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">DOCUMENT</span></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679151766"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; m Text
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m Text) -&gt; Text -&gt; m Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="annottext">[CMarkOption] -&gt; Maybe Int -&gt; Node -&gt; Text
</span><span class="hs-identifier hs-var">nodeToCommonmark</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [CMarkOption]
CMarkOption
</span><span class="hs-identifier hs-var">optSourcePos</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Item [CMarkOption]
CMarkOption
</span><span class="hs-identifier hs-var">optUnsafe</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Node
</span><a href="#local-6989586621679151770"><span class="hs-identifier hs-var">outputNode</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679151886"><span class="annot"><a href="#local-6989586621679151775"><span class="hs-identifier hs-type">fromNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151886"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151886"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.TagStack.html#HtmlTagStack"><span class="hs-identifier hs-type">HtmlTagStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679151886"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679151775"><span class="annot"><span class="annottext">fromNode :: HtmlTagStack -&gt; Node -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151775"><span class="hs-identifier hs-var hs-var">fromNode</span></a></span></span><span> </span><span id="local-6989586621679151763"><span class="annot"><span class="annottext">stack :: HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679151762"><span class="annot"><span class="annottext">posInfo :: Maybe PosInfo
</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">posInfo</span></a></span></span><span> </span><span id="local-6989586621679151761"><span class="annot"><span class="annottext">nodeType :: NodeType
</span><a href="#local-6989586621679151761"><span class="hs-identifier hs-var">nodeType</span></a></span></span><span> </span><span id="local-6989586621679151760"><span class="annot"><span class="annottext">children :: [Node]
</span><a href="#local-6989586621679151760"><span class="hs-identifier hs-var">children</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><a href="#local-6989586621679151761"><span class="hs-identifier hs-var">nodeType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-117"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">DOCUMENT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">nodeWithChildren</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Article"><span class="hs-identifier hs-var">Article</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">THEMATIC_BREAK</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-120"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlStartTag"><span class="hs-identifier hs-var">HtmlStartTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#HR"><span class="hs-identifier hs-var">HR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; Text
</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-var">posAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">posInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlEndTag"><span class="hs-identifier hs-var">HtmlEndTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#HR"><span class="hs-identifier hs-var">HR</span></a></span><span>
</span><span id="line-122"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">PARAGRAPH</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">nodeWithChildren</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#P"><span class="hs-identifier hs-var">P</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">BLOCK_QUOTE</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">nodeWithChildren</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#BlockQuote"><span class="hs-identifier hs-var">BlockQuote</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">HTML_BLOCK</span></span><span> </span><span id="local-6989586621679151747"><span class="annot"><span class="annottext">html :: Text
</span><a href="#local-6989586621679151747"><span class="hs-identifier hs-var">html</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-128"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Result [HtmlEntity]
</span><a href="Text.Seonbi.Html.Scanner.html#scanHtml"><span class="hs-identifier hs-var">scanHtml</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Result [HtmlEntity]) -&gt; Text -&gt; Result [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151747"><span class="hs-identifier hs-var">html</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Done</span></span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span id="local-6989586621679151746"><span class="annot"><span class="annottext">input' :: [HtmlEntity]
</span><a href="#local-6989586621679151746"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([HtmlEntity] -&gt; m [HtmlEntity]) -&gt; [HtmlEntity] -&gt; m [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [HtmlEntity]
</span><a href="#local-6989586621679151745"><span class="hs-identifier hs-var">rebaseStack</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151746"><span class="hs-identifier hs-var">input'</span></a></span><span>
</span><span id="line-130"></span><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HtmlTagStack -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlCdata"><span class="hs-identifier hs-var">HtmlCdata</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151747"><span class="hs-identifier hs-var">html</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CUSTOM_BLOCK</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>            </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CODE_BLOCK</span></span><span> </span><span id="local-6989586621679151741"><span class="annot"><span class="annottext">info :: Text
</span><a href="#local-6989586621679151741"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span id="local-6989586621679151740"><span class="annot"><span class="annottext">text' :: Text
</span><a href="#local-6989586621679151740"><span class="hs-identifier hs-var">text'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-134"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlStartTag"><span class="hs-identifier hs-var">HtmlStartTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Pre"><span class="hs-identifier hs-var">Pre</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; Text
</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-var">posAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">posInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Show a =&gt; Text -&gt; a -&gt; Text
</span><a href="#local-6989586621679151738"><span class="hs-identifier hs-var">attr'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;info&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151741"><span class="hs-identifier hs-var">info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlCdata"><span class="hs-identifier hs-var">HtmlCdata</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlTag -&gt; HtmlTagStack
</span><a href="#local-6989586621679151737"><span class="hs-identifier hs-var">nextStack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Pre"><span class="hs-identifier hs-var">Pre</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151740"><span class="hs-identifier hs-var">text'</span></a></span><span>
</span><span id="line-136"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlEndTag"><span class="hs-identifier hs-var">HtmlEndTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Pre"><span class="hs-identifier hs-var">Pre</span></a></span><span>
</span><span id="line-137"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">HEADING</span></span><span> </span><span id="local-6989586621679151735"><span class="annot"><span class="annottext">level :: Int
</span><a href="#local-6989586621679151735"><span class="hs-identifier hs-var">level</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">nodeWithChildren</span></a></span><span> </span><span class="annot"><span class="annottext">(HtmlTag -&gt; m [HtmlEntity]) -&gt; HtmlTag -&gt; m [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#headingTag%27"><span class="hs-identifier hs-var">headingTag'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679151735"><span class="hs-identifier hs-var">level</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">LIST</span></span><span> </span><span id="local-6989586621679151733"><span class="annot"><span class="annottext">listAttrs :: ListAttributes
</span><a href="#local-6989586621679151733"><span class="hs-identifier hs-var">listAttrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; Text -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; Text -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151732"><span class="hs-identifier hs-var">nodeWithChildren'</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#UL"><span class="hs-identifier hs-var">UL</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m [HtmlEntity]) -&gt; Text -&gt; m [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ListAttributes -&gt; Text
forall a. Show a =&gt; Text -&gt; a -&gt; Text
</span><a href="#local-6989586621679151738"><span class="hs-identifier hs-var">attr'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;list-attrs&quot;</span></span><span> </span><span class="annot"><span class="annottext">ListAttributes
</span><a href="#local-6989586621679151733"><span class="hs-identifier hs-var">listAttrs</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">ITEM</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">nodeWithChildren</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#LI"><span class="hs-identifier hs-var">LI</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">TEXT</span></span><span> </span><span id="local-6989586621679151727"><span class="annot"><span class="annottext">text' :: Text
</span><a href="#local-6989586621679151727"><span class="hs-identifier hs-var">text'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>            </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HtmlTagStack -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlCdata"><span class="hs-identifier hs-var">HtmlCdata</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151727"><span class="hs-identifier hs-var">text'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">SOFTBREAK</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-147"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlStartTag"><span class="hs-identifier hs-var">HtmlStartTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#BR"><span class="hs-identifier hs-var">BR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; Text
</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-var">posAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">posInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool -&gt; Text
forall a. Show a =&gt; Text -&gt; a -&gt; Text
</span><a href="#local-6989586621679151738"><span class="hs-identifier hs-var">attr'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;softbreak&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlEndTag"><span class="hs-identifier hs-var">HtmlEndTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#BR"><span class="hs-identifier hs-var">BR</span></a></span><span>
</span><span id="line-149"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">LINEBREAK</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlStartTag"><span class="hs-identifier hs-var">HtmlStartTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#BR"><span class="hs-identifier hs-var">BR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; Text
</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-var">posAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">posInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlEndTag"><span class="hs-identifier hs-var">HtmlEndTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#BR"><span class="hs-identifier hs-var">BR</span></a></span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">HTML_INLINE</span></span><span> </span><span id="local-6989586621679151722"><span class="annot"><span class="annottext">html :: Text
</span><a href="#local-6989586621679151722"><span class="hs-identifier hs-var">html</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Result [HtmlEntity]
</span><a href="Text.Seonbi.Html.Scanner.html#scanHtml"><span class="hs-identifier hs-var">scanHtml</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Result [HtmlEntity]) -&gt; Text -&gt; Result [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151722"><span class="hs-identifier hs-var">html</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-156"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Done</span></span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span id="local-6989586621679151721"><span class="annot"><span class="annottext">input' :: [HtmlEntity]
</span><a href="#local-6989586621679151721"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([HtmlEntity] -&gt; m [HtmlEntity]) -&gt; [HtmlEntity] -&gt; m [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [HtmlEntity]
</span><a href="#local-6989586621679151745"><span class="hs-identifier hs-var">rebaseStack</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151721"><span class="hs-identifier hs-var">input'</span></a></span><span>
</span><span id="line-157"></span><span>                </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HtmlTagStack -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlCdata"><span class="hs-identifier hs-var">HtmlCdata</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151722"><span class="hs-identifier hs-var">html</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CUSTOM_INLINE</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>            </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">CODE</span></span><span> </span><span id="local-6989586621679151718"><span class="annot"><span class="annottext">text' :: Text
</span><a href="#local-6989586621679151718"><span class="hs-identifier hs-var">text'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-161"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlStartTag"><span class="hs-identifier hs-var">HtmlStartTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Code"><span class="hs-identifier hs-var">Code</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; Text
</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-var">posAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">posInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlCdata"><span class="hs-identifier hs-var">HtmlCdata</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlTag -&gt; HtmlTagStack
</span><a href="#local-6989586621679151737"><span class="hs-identifier hs-var">nextStack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Code"><span class="hs-identifier hs-var">Code</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151718"><span class="hs-identifier hs-var">text'</span></a></span><span>
</span><span id="line-163"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlEndTag"><span class="hs-identifier hs-var">HtmlEndTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Code"><span class="hs-identifier hs-var">Code</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">EMPH</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">nodeWithChildren</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Em"><span class="hs-identifier hs-var">Em</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">STRONG</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var">nodeWithChildren</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Strong"><span class="hs-identifier hs-var">Strong</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">LINK</span></span><span> </span><span id="local-6989586621679151711"><span class="annot"><span class="annottext">href :: Text
</span><a href="#local-6989586621679151711"><span class="hs-identifier hs-var">href</span></a></span></span><span> </span><span id="local-6989586621679151710"><span class="annot"><span class="annottext">title :: Text
</span><a href="#local-6989586621679151710"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-170"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; Text -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; Text -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151732"><span class="hs-identifier hs-var">nodeWithChildren'</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m [HtmlEntity]) -&gt; Text -&gt; m [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="#local-6989586621679151708"><span class="hs-identifier hs-var">rawAttr</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; href&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151711"><span class="hs-identifier hs-var">href</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="#local-6989586621679151708"><span class="hs-identifier hs-var">rawAttr</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; title&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151710"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">IMAGE</span></span><span> </span><span id="local-6989586621679151706"><span class="annot"><span class="annottext">src :: Text
</span><a href="#local-6989586621679151706"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621679151705"><span class="annot"><span class="annottext">title :: Text
</span><a href="#local-6989586621679151705"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>            </span><span class="annot"><span class="annottext">HtmlTag -&gt; Text -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; Text -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151732"><span class="hs-identifier hs-var">nodeWithChildren'</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="Text.Seonbi.Html.Tag.html#Img"><span class="hs-identifier hs-var">Img</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m [HtmlEntity]) -&gt; Text -&gt; m [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="#local-6989586621679151708"><span class="hs-identifier hs-var">rawAttr</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; src&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151706"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="#local-6989586621679151708"><span class="hs-identifier hs-var">rawAttr</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot; title&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151705"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-173"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><a href="#local-6989586621679151737"><span class="hs-identifier hs-type">nextStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#HtmlTag"><span class="hs-identifier hs-type">HtmlTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.TagStack.html#HtmlTagStack"><span class="hs-identifier hs-type">HtmlTagStack</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span id="local-6989586621679151737"><span class="annot"><span class="annottext">nextStack :: HtmlTag -&gt; HtmlTagStack
</span><a href="#local-6989586621679151737"><span class="hs-identifier hs-var hs-var">nextStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlTag -&gt; HtmlTagStack -&gt; HtmlTagStack
</span><a href="Text.Seonbi.Html.TagStack.html#push"><span class="hs-operator hs-var">`TagStack.push`</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>        </span><span id="local-6989586621679151880"><span class="annot"><a href="#local-6989586621679151759"><span class="hs-identifier hs-type">nodeWithChildren</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151880"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151880"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#HtmlTag"><span class="hs-identifier hs-type">HtmlTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679151880"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-177"></span><span>        </span><span id="local-6989586621679151759"><span class="annot"><span class="annottext">nodeWithChildren :: HtmlTag -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-var hs-var">nodeWithChildren</span></a></span></span><span> </span><span id="local-6989586621679151702"><span class="annot"><span class="annottext">tag' :: HtmlTag
</span><a href="#local-6989586621679151702"><span class="hs-identifier hs-var">tag'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HtmlTag -&gt; Text -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTag -&gt; Text -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151732"><span class="hs-identifier hs-var">nodeWithChildren'</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151702"><span class="hs-identifier hs-var">tag'</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-178"></span><span>        </span><span id="local-6989586621679151876"><span class="annot"><a href="#local-6989586621679151732"><span class="hs-identifier hs-type">nodeWithChildren'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151876"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151876"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#HtmlTag"><span class="hs-identifier hs-type">HtmlTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679151876"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-180"></span><span>        </span><span id="local-6989586621679151732"><span class="annot"><span class="annottext">nodeWithChildren' :: HtmlTag -&gt; Text -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151732"><span class="hs-identifier hs-var hs-var">nodeWithChildren'</span></a></span></span><span> </span><span id="local-6989586621679151701"><span class="annot"><span class="annottext">tag' :: HtmlTag
</span><a href="#local-6989586621679151701"><span class="hs-identifier hs-var">tag'</span></a></span></span><span> </span><span id="local-6989586621679151700"><span class="annot"><span class="annottext">extraAttrs :: Text
</span><a href="#local-6989586621679151700"><span class="hs-identifier hs-var">extraAttrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>            </span><span id="local-6989586621679151699"><span class="annot"><span class="annottext">[[HtmlEntity]]
</span><a href="#local-6989586621679151699"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Node] -&gt; (Node -&gt; m [HtmlEntity]) -&gt; m [[HtmlEntity]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679151760"><span class="hs-identifier hs-var">children</span></a></span><span> </span><span class="annot"><span class="annottext">((Node -&gt; m [HtmlEntity]) -&gt; m [[HtmlEntity]])
-&gt; (Node -&gt; m [HtmlEntity]) -&gt; m [[HtmlEntity]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>                </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; Node -&gt; m [HtmlEntity]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
HtmlTagStack -&gt; Node -&gt; m [HtmlEntity]
</span><a href="#local-6989586621679151775"><span class="hs-identifier hs-var">fromNode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlTag -&gt; HtmlTagStack
</span><a href="#local-6989586621679151737"><span class="hs-identifier hs-var">nextStack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151701"><span class="hs-identifier hs-var">tag'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679151698"><span class="annot"><span class="annottext">middle :: [HtmlEntity]
</span><a href="#local-6989586621679151698"><span class="hs-identifier hs-var hs-var">middle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[HtmlEntity]] -&gt; [HtmlEntity]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">Data.List.concat</span></span><span> </span><span class="annot"><span class="annottext">[[HtmlEntity]]
</span><a href="#local-6989586621679151699"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-184"></span><span>            </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; m [HtmlEntity]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([HtmlEntity] -&gt; m [HtmlEntity]) -&gt; [HtmlEntity] -&gt; m [HtmlEntity]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; Text -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlStartTag"><span class="hs-identifier hs-var">HtmlStartTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151701"><span class="hs-identifier hs-var">tag'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; Text
</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-var">posAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-var">posInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151700"><span class="hs-identifier hs-var">extraAttrs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HtmlEntity -&gt; [HtmlEntity] -&gt; [HtmlEntity]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-185"></span><span>                </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151698"><span class="hs-identifier hs-var">middle</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [HtmlEntity] -&gt; [HtmlEntity]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; HtmlEntity
</span><a href="Text.Seonbi.Html.Entity.html#HtmlEndTag"><span class="hs-identifier hs-var">HtmlEndTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151701"><span class="hs-identifier hs-var">tag'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>        </span><span class="annot"><a href="#local-6989586621679151696"><span class="hs-identifier hs-type">rebase'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.TagStack.html#HtmlTagStack"><span class="hs-identifier hs-type">HtmlTagStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.TagStack.html#HtmlTagStack"><span class="hs-identifier hs-type">HtmlTagStack</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679151696"><span class="annot"><span class="annottext">rebase' :: HtmlTagStack -&gt; HtmlTagStack
</span><a href="#local-6989586621679151696"><span class="hs-identifier hs-var hs-var">rebase'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTagStack -&gt; HtmlTagStack -&gt; HtmlTagStack
</span><a href="Text.Seonbi.Html.TagStack.html#rebase"><span class="hs-identifier hs-var">TagStack.rebase</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-var">stack</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><a href="#local-6989586621679151745"><span class="hs-identifier hs-type">rebaseStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-189"></span><span>        </span><span id="local-6989586621679151745"><span class="annot"><span class="annottext">rebaseStack :: [HtmlEntity] -&gt; [HtmlEntity]
</span><a href="#local-6989586621679151745"><span class="hs-identifier hs-var hs-var">rebaseStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HtmlEntity -&gt; HtmlEntity) -&gt; [HtmlEntity] -&gt; [HtmlEntity]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">Prelude.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679151694"><span class="annot"><span class="annottext">e :: HtmlEntity
</span><a href="#local-6989586621679151694"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HtmlEntity
</span><a href="#local-6989586621679151694"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tagStack :: HtmlTagStack
</span><a href="Text.Seonbi.Html.Entity.html#tagStack"><span class="hs-identifier hs-var">tagStack</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTagStack
</span><a href="#local-6989586621679151696"><span class="hs-identifier hs-var">rebase'</span></a></span><span> </span><span class="annot"><span class="annottext">(HtmlTagStack -&gt; HtmlTagStack) -&gt; HtmlTagStack -&gt; HtmlTagStack
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HtmlEntity -&gt; HtmlTagStack
</span><a href="Text.Seonbi.Html.Entity.html#tagStack"><span class="hs-identifier hs-var hs-var">tagStack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlEntity
</span><a href="#local-6989586621679151694"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="#local-6989586621679151771"><span class="hs-identifier hs-type">toNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679151771"><span class="annot"><span class="annottext">toNode :: [HtmlEntity] -&gt; [Node]
</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-var hs-var">toNode</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="#local-6989586621679151771"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679151692"><span class="annot"><span class="annottext">x :: HtmlEntity
</span><a href="#local-6989586621679151692"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679151691"><span class="annot"><span class="annottext">xs :: [HtmlEntity]
</span><a href="#local-6989586621679151691"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HtmlEntity
</span><a href="#local-6989586621679151692"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-193"></span><span>        </span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlComment"><span class="hs-identifier hs-type">HtmlComment</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679151689"><span class="annot"><span class="annottext">comment' :: Text
</span><a href="#local-6989586621679151689"><span class="hs-identifier hs-var">comment'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-194"></span><span>            </span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; NodeType -&gt; [Node] -&gt; Node
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NodeType
</span><a href="#local-6989586621679151688"><span class="hs-identifier hs-var">htmlNode</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151689"><span class="hs-identifier hs-var">comment'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Node -&gt; [Node] -&gt; [Node]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [Node]
</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151691"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlCdata"><span class="hs-identifier hs-type">HtmlCdata</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679151687"><span class="annot"><span class="annottext">cdata :: Text
</span><a href="#local-6989586621679151687"><span class="hs-identifier hs-var">cdata</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; NodeType -&gt; [Node] -&gt; Node
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NodeType
</span><span class="hs-identifier hs-var">TEXT</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151687"><span class="hs-identifier hs-var">cdata</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Node -&gt; [Node] -&gt; [Node]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [Node]
</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151691"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlText"><span class="hs-identifier hs-type">HtmlText</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span id="local-6989586621679151686"><span class="annot"><span class="annottext">rawText' :: Text
</span><a href="#local-6989586621679151686"><span class="hs-identifier hs-var">rawText'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-198"></span><span>            </span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; NodeType -&gt; [Node] -&gt; Node
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; NodeType
</span><span class="hs-identifier hs-var">TEXT</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; NodeType) -&gt; Text -&gt; NodeType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="#local-6989586621679151685"><span class="hs-identifier hs-var">unescape</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151686"><span class="hs-identifier hs-var">rawText'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Node -&gt; [Node] -&gt; [Node]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [Node]
</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151691"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEndTag"><span class="hs-identifier hs-type">HtmlEndTag</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>            </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [Node]
</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151691"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621679151684"><span class="annot"><span class="annottext">start :: HtmlEntity
</span><a href="#local-6989586621679151684"><span class="hs-identifier hs-var">start</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlStartTag"><span class="hs-identifier hs-type">HtmlStartTag</span></a></span><span> </span><span id="local-6989586621679151683"><span class="annot"><span class="annottext">stack :: HtmlTagStack
</span><a href="#local-6989586621679151683"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span id="local-6989586621679151682"><span class="annot"><span class="annottext">tag' :: HtmlTag
</span><a href="#local-6989586621679151682"><span class="hs-identifier hs-var">tag'</span></a></span></span><span> </span><span id="local-6989586621679151681"><span class="annot"><span class="annottext">attrs :: Text
</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">attrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679151680"><span class="annot"><span class="annottext">children' :: [HtmlEntity]
</span><a href="#local-6989586621679151680"><span class="hs-identifier hs-var">children'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679151679"><span class="annot"><span class="annottext">rest :: [HtmlEntity]
</span><a href="#local-6989586621679151679"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HtmlEntity -&gt; Bool)
-&gt; [HtmlEntity] -&gt; ([HtmlEntity], [HtmlEntity])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">Data.List.break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTag -&gt; HtmlEntity -&gt; Bool
</span><a href="#local-6989586621679151677"><span class="hs-identifier hs-var">endOf</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151683"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151682"><span class="hs-identifier hs-var">tag'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151691"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-203"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679151676"><span class="annot"><span class="annottext">end :: [HtmlEntity]
</span><a href="#local-6989586621679151676"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679151675"><span class="annot"><span class="annottext">rest' :: [HtmlEntity]
</span><a href="#local-6989586621679151675"><span class="hs-identifier hs-var">rest'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151679"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-204"></span><span>                    </span><span id="local-6989586621679151674"><span class="annot"><span class="annottext">end' :: HtmlEntity
</span><a href="#local-6989586621679151674"><span class="hs-identifier hs-var">end'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEndTag"><span class="hs-identifier hs-type">HtmlEndTag</span></a></span><span> </span><span id="local-6989586621679151673"><span class="annot"><span class="annottext">endStack :: HtmlTagStack
</span><a href="#local-6989586621679151673"><span class="hs-identifier hs-var">endStack</span></a></span></span><span> </span><span id="local-6989586621679151672"><span class="annot"><span class="annottext">endTag :: HtmlTag
</span><a href="#local-6989586621679151672"><span class="hs-identifier hs-var">endTag</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679151671"><span class="annot"><span class="annottext">afterEnd :: [HtmlEntity]
</span><a href="#local-6989586621679151671"><span class="hs-identifier hs-var">afterEnd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>                        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151673"><span class="hs-identifier hs-var">endStack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTagStack -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151683"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151672"><span class="hs-identifier hs-var">endTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag -&gt; HtmlTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151682"><span class="hs-identifier hs-var">tag'</span></a></span><span>
</span><span id="line-206"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [HtmlEntity]
HtmlEntity
</span><a href="#local-6989586621679151674"><span class="hs-identifier hs-var">end'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151671"><span class="hs-identifier hs-var">afterEnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151679"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151679"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>                </span><span id="local-6989586621679151669"><span class="annot"><span class="annottext">posInfo :: Maybe PosInfo
</span><a href="#local-6989586621679151669"><span class="hs-identifier hs-var hs-var">posInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; Maybe (Maybe PosInfo) -&gt; Maybe PosInfo
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-210"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe (Maybe PosInfo)
forall a. Read a =&gt; Text -&gt; Text -&gt; Maybe a
</span><a href="#local-6989586621679151668"><span class="hs-identifier hs-var">getAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;posinfo&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PosInfo</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>                </span><span id="local-6989586621679151667"><span class="annot"><span class="annottext">softbreak :: Maybe Bool
</span><a href="#local-6989586621679151667"><span class="hs-identifier hs-var hs-var">softbreak</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Bool
forall a. Read a =&gt; Text -&gt; Text -&gt; Maybe a
</span><a href="#local-6989586621679151668"><span class="hs-identifier hs-var">getAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;softbreak&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-212"></span><span>                </span><span id="local-6989586621679151666"><span class="annot"><span class="annottext">childrenHtmlNode :: NodeType
</span><a href="#local-6989586621679151666"><span class="hs-identifier hs-var hs-var">childrenHtmlNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; NodeType
</span><a href="#local-6989586621679151688"><span class="hs-identifier hs-var">htmlNode</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; NodeType) -&gt; Text -&gt; NodeType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">LT.toStrict</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; Text
</span><a href="Text.Seonbi.Html.Printer.html#printHtml"><span class="hs-identifier hs-var">printHtml</span></a></span><span> </span><span class="annot"><span class="annottext">([HtmlEntity] -&gt; Text) -&gt; [HtmlEntity] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-213"></span><span>                    </span><span class="annot"><span class="annottext">HtmlEntity
</span><a href="#local-6989586621679151684"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlEntity -&gt; [HtmlEntity] -&gt; [HtmlEntity]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151680"><span class="hs-identifier hs-var">children'</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [HtmlEntity] -&gt; [HtmlEntity]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151676"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-214"></span><span>                </span><span id="local-6989586621679151665"><span class="annot"><span class="annottext">nodeType :: NodeType
</span><a href="#local-6989586621679151665"><span class="hs-identifier hs-var hs-var">nodeType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151682"><span class="hs-identifier hs-var">tag'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-215"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#Article"><span class="hs-identifier hs-type">Article</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">DOCUMENT</span></span><span>
</span><span id="line-216"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#BlockQuote"><span class="hs-identifier hs-type">BlockQuote</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">BLOCK_QUOTE</span></span><span>
</span><span id="line-217"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#HR"><span class="hs-identifier hs-type">HR</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">THEMATIC_BREAK</span></span><span>
</span><span id="line-218"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">PARAGRAPH</span></span><span>
</span><span id="line-219"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#Pre"><span class="hs-identifier hs-type">Pre</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
forall a. Read a =&gt; Text -&gt; Text -&gt; Maybe a
</span><a href="#local-6989586621679151668"><span class="hs-identifier hs-var">getAttr</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;info&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-220"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679151664"><span class="annot"><span class="annottext">info :: Text
</span><a href="#local-6989586621679151664"><span class="hs-identifier hs-var">info</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; NodeType
</span><span class="hs-identifier hs-var">CODE_BLOCK</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151664"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; NodeType) -&gt; Text -&gt; NodeType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; Text
</span><a href="#local-6989586621679151663"><span class="hs-identifier hs-var">printText'</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151680"><span class="hs-identifier hs-var">children'</span></a></span><span>
</span><span id="line-221"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><a href="#local-6989586621679151666"><span class="hs-identifier hs-var">childrenHtmlNode</span></a></span><span>
</span><span id="line-222"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#UL"><span class="hs-identifier hs-type">UL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>                        </span><span class="annot"><span class="annottext">NodeType
-&gt; (ListAttributes -&gt; NodeType) -&gt; Maybe ListAttributes -&gt; NodeType
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">NodeType
</span><a href="#local-6989586621679151666"><span class="hs-identifier hs-var">childrenHtmlNode</span></a></span><span> </span><span class="annot"><span class="annottext">ListAttributes -&gt; NodeType
</span><span class="hs-identifier hs-var">LIST</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe ListAttributes
forall a. Read a =&gt; Text -&gt; Text -&gt; Maybe a
</span><a href="#local-6989586621679151668"><span class="hs-identifier hs-var">getAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;list-attrs&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#LI"><span class="hs-identifier hs-type">LI</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">ITEM</span></span><span>
</span><span id="line-225"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#BR"><span class="hs-identifier hs-type">BR</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>                        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679151667"><span class="hs-identifier hs-var">softbreak</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Maybe Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">SOFTBREAK</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">LINEBREAK</span></span><span>
</span><span id="line-227"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#Code"><span class="hs-identifier hs-type">Code</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; NodeType
</span><span class="hs-identifier hs-var">CODE</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; NodeType) -&gt; Text -&gt; NodeType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; Text
</span><a href="#local-6989586621679151663"><span class="hs-identifier hs-var">printText'</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151680"><span class="hs-identifier hs-var">children'</span></a></span><span>
</span><span id="line-228"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#Em"><span class="hs-identifier hs-type">Em</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">EMPH</span></span><span>
</span><span id="line-229"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#Strong"><span class="hs-identifier hs-type">Strong</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NodeType
</span><span class="hs-identifier hs-var">STRONG</span></span><span>
</span><span id="line-230"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#A"><span class="hs-identifier hs-type">A</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; NodeType
</span><span class="hs-identifier hs-var">LINK</span></span><span>
</span><span id="line-231"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Text
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">ST.empty</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><a href="#local-6989586621679151660"><span class="hs-identifier hs-var">getRawAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;href&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Text
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">ST.empty</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><a href="#local-6989586621679151660"><span class="hs-identifier hs-var">getRawAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;title&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>                    </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#Img"><span class="hs-identifier hs-type">Img</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; NodeType
</span><span class="hs-identifier hs-var">IMAGE</span></span><span>
</span><span id="line-234"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Text
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">ST.empty</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><a href="#local-6989586621679151660"><span class="hs-identifier hs-var">getRawAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;src&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Text
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">ST.empty</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Text) -&gt; Maybe Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><a href="#local-6989586621679151660"><span class="hs-identifier hs-var">getRawAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;title&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>                        </span><span class="annot"><span class="annottext">NodeType -&gt; (Int -&gt; NodeType) -&gt; Maybe Int -&gt; NodeType
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">NodeType
</span><a href="#local-6989586621679151666"><span class="hs-identifier hs-var">childrenHtmlNode</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; NodeType
</span><span class="hs-identifier hs-var">HEADING</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlTag -&gt; Maybe Int
</span><a href="Text.Seonbi.Html.Tag.html#headingLevel"><span class="hs-identifier hs-var">headingLevel</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151682"><span class="hs-identifier hs-var">tag'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679151659"><span class="annot"><span class="annottext">nodeType' :: NodeType
</span><a href="#local-6989586621679151659"><span class="hs-identifier hs-var">nodeType'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679151658"><span class="annot"><span class="annottext">nodeChildren :: [Node]
</span><a href="#local-6989586621679151658"><span class="hs-identifier hs-var">nodeChildren</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-239"></span><span>                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
</span><a href="#local-6989586621679151669"><span class="hs-identifier hs-var">posInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621679151667"><span class="hs-identifier hs-var">softbreak</span></a></span><span>
</span><span id="line-240"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeType
</span><a href="#local-6989586621679151666"><span class="hs-identifier hs-var">childrenHtmlNode</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NodeType
</span><a href="#local-6989586621679151665"><span class="hs-identifier hs-var">nodeType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [Node]
</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151680"><span class="hs-identifier hs-var">children'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-243"></span><span>                </span><span class="annot"><span class="annottext">Maybe PosInfo -&gt; NodeType -&gt; [Node] -&gt; Node
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">Maybe PosInfo
</span><a href="#local-6989586621679151669"><span class="hs-identifier hs-var">posInfo</span></a></span><span> </span><span class="annot"><span class="annottext">NodeType
</span><a href="#local-6989586621679151659"><span class="hs-identifier hs-var">nodeType'</span></a></span><span> </span><span class="annot"><span class="annottext">[Node]
</span><a href="#local-6989586621679151658"><span class="hs-identifier hs-var">nodeChildren</span></a></span><span> </span><span class="annot"><span class="annottext">Node -&gt; [Node] -&gt; [Node]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; [Node]
</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-var">toNode</span></a></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity]
</span><a href="#local-6989586621679151675"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-244"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>        </span><span class="annot"><a href="#local-6989586621679151657"><span class="hs-identifier hs-type">block</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-246"></span><span>        </span><span id="local-6989586621679151657"><span class="annot"><span class="annottext">block :: Bool
</span><a href="#local-6989586621679151657"><span class="hs-identifier hs-var hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; Maybe HtmlTag
</span><a href="Text.Seonbi.Html.TagStack.html#last"><span class="hs-identifier hs-var">TagStack.last</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlEntity -&gt; HtmlTagStack
</span><a href="Text.Seonbi.Html.Entity.html#tagStack"><span class="hs-identifier hs-var hs-var">tagStack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlEntity
</span><a href="#local-6989586621679151692"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-247"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#A"><span class="hs-identifier hs-type">A</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-248"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#Em"><span class="hs-identifier hs-type">Em</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-249"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#H1"><span class="hs-identifier hs-type">H1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-250"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#H2"><span class="hs-identifier hs-type">H2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-251"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#H3"><span class="hs-identifier hs-type">H3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-252"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#H4"><span class="hs-identifier hs-type">H4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-253"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#H5"><span class="hs-identifier hs-type">H5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-254"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#H6"><span class="hs-identifier hs-type">H6</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-255"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#P"><span class="hs-identifier hs-type">P</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-256"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#Strong"><span class="hs-identifier hs-type">Strong</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-257"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679151649"><span class="annot"><span class="annottext">tag' :: HtmlTag
</span><a href="#local-6989586621679151649"><span class="hs-identifier hs-var">tag'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlTag -&gt; Maybe Int
</span><a href="Text.Seonbi.Html.Tag.html#headingLevel"><span class="hs-identifier hs-var">headingLevel</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151649"><span class="hs-identifier hs-var">tag'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><a href="#local-6989586621679151688"><span class="hs-identifier hs-type">htmlNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NodeType</span></span><span>
</span><span id="line-260"></span><span>        </span><span id="local-6989586621679151688"><span class="annot"><span class="annottext">htmlNode :: Text -&gt; NodeType
</span><a href="#local-6989586621679151688"><span class="hs-identifier hs-var hs-var">htmlNode</span></a></span></span><span>
</span><span id="line-261"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679151657"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; NodeType
</span><span class="hs-identifier hs-var">HTML_BLOCK</span></span><span>
</span><span id="line-262"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; NodeType
</span><span class="hs-identifier hs-var">HTML_INLINE</span></span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><a href="#local-6989586621679151685"><span class="hs-identifier hs-type">unescape</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679151685"><span class="annot"><span class="annottext">unescape :: Text -&gt; Text
</span><a href="#local-6989586621679151685"><span class="hs-identifier hs-var hs-var">unescape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">toStrict</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (Text -&gt; Text) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; (Text -&gt; Builder) -&gt; Text -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">htmlEncodedText</span></span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="#local-6989586621679151708"><span class="hs-identifier hs-type">rawAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621679151708"><span class="annot"><span class="annottext">rawAttr :: Text -&gt; Text -&gt; Text
</span><a href="#local-6989586621679151708"><span class="hs-identifier hs-var hs-var">rawAttr</span></a></span></span><span> </span><span id="local-6989586621679151646"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679151646"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679151645"><span class="annot"><span class="annottext">value :: Text
</span><a href="#local-6989586621679151645"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">ST.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151646"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">toStrict</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="hs-string">&quot;=\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">HTMLEntities.Builder.text</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151645"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\&quot;&quot;</span></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679151643"><span class="annot"><a href="#local-6989586621679151642"><span class="hs-identifier hs-type">attr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679151643"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679151643"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679151642"><span class="annot"><span class="annottext">attr :: Text -&gt; a -&gt; Text
</span><a href="#local-6989586621679151642"><span class="hs-identifier hs-var hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679151641"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679151641"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679151640"><span class="annot"><span class="annottext">value :: a
</span><a href="#local-6989586621679151640"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="#local-6989586621679151708"><span class="hs-identifier hs-var">rawAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;data-seonbi-cmark-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151641"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">ST.pack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679151640"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679151878"><span class="annot"><a href="#local-6989586621679151738"><span class="hs-identifier hs-type">attr'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679151878"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679151878"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679151738"><span class="annot"><span class="annottext">attr' :: Text -&gt; a -&gt; Text
</span><a href="#local-6989586621679151738"><span class="hs-identifier hs-var hs-var">attr'</span></a></span></span><span> </span><span id="local-6989586621679151637"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679151637"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">ST.cons</span></span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; (a -&gt; Text) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; a -&gt; Text
forall a. Show a =&gt; Text -&gt; a -&gt; Text
</span><a href="#local-6989586621679151642"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151637"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="#local-6989586621679151754"><span class="hs-identifier hs-type">posAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PosInfo</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679151754"><span class="annot"><span class="annottext">posAttr :: Maybe PosInfo -&gt; Text
</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-var hs-var">posAttr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe PosInfo -&gt; Text
forall a. Show a =&gt; Text -&gt; a -&gt; Text
</span><a href="#local-6989586621679151642"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;posinfo&quot;</span></span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="#local-6989586621679151660"><span class="hs-identifier hs-type">getRawAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlRawAttrs"><span class="hs-identifier hs-type">HtmlRawAttrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679151660"><span class="annot"><span class="annottext">getRawAttr :: Text -&gt; Text -&gt; Maybe Text
</span><a href="#local-6989586621679151660"><span class="hs-identifier hs-var hs-var">getRawAttr</span></a></span></span><span> </span><span id="local-6989586621679151634"><span class="annot"><span class="annottext">attrs :: Text
</span><a href="#local-6989586621679151634"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679151633"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679151633"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">ST.breakOn</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151631"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151634"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-278"></span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-279"></span><span>            </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679151630"><span class="annot"><span class="annottext">head' :: Text
</span><a href="#local-6989586621679151630"><span class="hs-identifier hs-var">head'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; (Text, Text)
</span><span class="hs-identifier hs-var">ST.break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">ST.drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">ST.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151631"><span class="hs-identifier hs-var">prefix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151630"><span class="hs-identifier hs-var">head'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-281"></span><span>                    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-282"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621679151626"><span class="annot"><span class="annottext">value :: Text
</span><a href="#local-6989586621679151626"><span class="hs-identifier hs-var">value</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-283"></span><span>                        </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">toStrict</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; Builder -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Builder
</span><span class="hs-identifier hs-var">htmlEncodedText</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151626"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><a href="#local-6989586621679151631"><span class="hs-identifier hs-type">prefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span>
</span><span id="line-286"></span><span>        </span><span id="local-6989586621679151631"><span class="annot"><span class="annottext">prefix :: Text
</span><a href="#local-6989586621679151631"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151633"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;=\&quot;&quot;</span></span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679151861"><span class="annot"><a href="#local-6989586621679151668"><span class="hs-identifier hs-type">getAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679151861"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlRawAttrs"><span class="hs-identifier hs-type">HtmlRawAttrs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679151861"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679151668"><span class="annot"><span class="annottext">getAttr :: Text -&gt; Text -&gt; Maybe a
</span><a href="#local-6989586621679151668"><span class="hs-identifier hs-var hs-var">getAttr</span></a></span></span><span> </span><span id="local-6989586621679151625"><span class="annot"><span class="annottext">attrs :: Text
</span><a href="#local-6989586621679151625"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679151624"><span class="annot"><span class="annottext">name :: Text
</span><a href="#local-6989586621679151624"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Maybe Text
</span><a href="#local-6989586621679151660"><span class="hs-identifier hs-var">getRawAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151625"><span class="hs-identifier hs-var">attrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;data-seonbi-cmark-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151624"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-291"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679151623"><span class="annot"><span class="annottext">value :: Text
</span><a href="#local-6989586621679151623"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe a
forall a. Read a =&gt; String -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe a) -&gt; String -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">ST.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151623"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><a href="#local-6989586621679151677"><span class="hs-identifier hs-type">endOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.TagStack.html#HtmlTagStack"><span class="hs-identifier hs-type">HtmlTagStack</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Tag.html#HtmlTag"><span class="hs-identifier hs-type">HtmlTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679151677"><span class="annot"><span class="annottext">endOf :: HtmlTagStack -&gt; HtmlTag -&gt; HtmlEntity -&gt; Bool
</span><a href="#local-6989586621679151677"><span class="hs-identifier hs-var hs-var">endOf</span></a></span></span><span> </span><span id="local-6989586621679151621"><span class="annot"><span class="annottext">stack :: HtmlTagStack
</span><a href="#local-6989586621679151621"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span id="local-6989586621679151620"><span class="annot"><span class="annottext">tag' :: HtmlTag
</span><a href="#local-6989586621679151620"><span class="hs-identifier hs-var">tag'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEndTag"><span class="hs-identifier hs-type">HtmlEndTag</span></a></span><span> </span><span id="local-6989586621679151619"><span class="annot"><span class="annottext">endStack :: HtmlTagStack
</span><a href="#local-6989586621679151619"><span class="hs-identifier hs-var">endStack</span></a></span></span><span> </span><span id="local-6989586621679151618"><span class="annot"><span class="annottext">endTag :: HtmlTag
</span><a href="#local-6989586621679151618"><span class="hs-identifier hs-var">endTag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151619"><span class="hs-identifier hs-var">endStack</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack -&gt; HtmlTagStack -&gt; Bool
</span><a href="Text.Seonbi.Html.TagStack.html#descendsFrom"><span class="hs-operator hs-var">`TagStack.descendsFrom`</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTagStack
</span><a href="#local-6989586621679151621"><span class="hs-identifier hs-var">stack</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151618"><span class="hs-identifier hs-var">endTag</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTag -&gt; HtmlTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">HtmlTag
</span><a href="#local-6989586621679151620"><span class="hs-identifier hs-var">tag'</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="#local-6989586621679151677"><span class="hs-identifier hs-var">endOf</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="#local-6989586621679151663"><span class="hs-identifier hs-type">printText'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Seonbi.Html.Entity.html#HtmlEntity"><span class="hs-identifier hs-type">HtmlEntity</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679151663"><span class="annot"><span class="annottext">printText' :: [HtmlEntity] -&gt; Text
</span><a href="#local-6989586621679151663"><span class="hs-identifier hs-var hs-var">printText'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">toStrict</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; ([HtmlEntity] -&gt; Text) -&gt; [HtmlEntity] -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[HtmlEntity] -&gt; Text
</span><a href="Text.Seonbi.Html.Printer.html#printText"><span class="hs-identifier hs-var">printText</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- | Represents a case-insensitive content type.</span><span>
</span><span id="line-301"></span><span class="hs-keyword">type</span><span> </span><span id="ContentType"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#ContentType"><span class="hs-identifier hs-var">ContentType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MediaType</span></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Converts a 'Text' to a 'ContentType'.</span><span>
</span><span id="line-304"></span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#contentTypeFromText"><span class="hs-identifier hs-type">contentTypeFromText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#ContentType"><span class="hs-identifier hs-type">ContentType</span></a></span><span>
</span><span id="line-305"></span><span id="contentTypeFromText"><span class="annot"><span class="annottext">contentTypeFromText :: Text -&gt; Maybe ContentType
</span><a href="Text.Seonbi.ContentTypes.html#contentTypeFromText"><span class="hs-identifier hs-var hs-var">contentTypeFromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ContentType
forall a. Accept a =&gt; ByteString -&gt; Maybe a
</span><span class="hs-identifier hs-var">parseAccept</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ContentType)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; Maybe ContentType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Converts a 'ContentType' to a 'Text'.</span><span>
</span><span id="line-308"></span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#contentTypeText"><span class="hs-identifier hs-type">contentTypeText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#ContentType"><span class="hs-identifier hs-type">ContentType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ST.Text</span></span><span>
</span><span id="line-309"></span><span id="contentTypeText"><span class="annot"><span class="annottext">contentTypeText :: ContentType -&gt; Text
</span><a href="Text.Seonbi.ContentTypes.html#contentTypeText"><span class="hs-identifier hs-var hs-var">contentTypeText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text)
-&gt; (ContentType -&gt; ByteString) -&gt; ContentType -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ContentType -&gt; ByteString
forall h. RenderHeader h =&gt; h -&gt; ByteString
</span><span class="hs-identifier hs-var">renderHeader</span></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-keyword">newtype</span><span> </span><span id="TransformerTransformer%27"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-var">TransformerTransformer'</span></a></span></span><span> </span><span id="local-6989586621679151841"><span class="annot"><a href="#local-6989586621679151841"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-312"></span><span>    </span><span id="TransformerTransformer%27"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-var">TransformerTransformer'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer"><span class="hs-identifier hs-type">TransformerTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151841"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span id="local-6989586621679151835"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#transformers"><span class="hs-identifier hs-type">transformers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151835"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151835"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#ContentType"><span class="hs-identifier hs-type">ContentType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-type">TransformerTransformer'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151835"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-315"></span><span id="transformers"><span class="annot"><span class="annottext">transformers :: [(ContentType, TransformerTransformer' m)]
</span><a href="Text.Seonbi.ContentTypes.html#transformers"><span class="hs-identifier hs-var hs-var">transformers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;text/html&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TransformerTransformer m -&gt; TransformerTransformer' m
forall (m :: * -&gt; *).
TransformerTransformer m -&gt; TransformerTransformer' m
</span><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-var">TransformerTransformer'</span></a></span><span> </span><span class="annot"><span class="annottext">TransformerTransformer m
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
TransformerTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asHtmlTransformer"><span class="hs-identifier hs-var">asHtmlTransformer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;application/xhtml+xml&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TransformerTransformer m -&gt; TransformerTransformer' m
forall (m :: * -&gt; *).
TransformerTransformer m -&gt; TransformerTransformer' m
</span><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-var">TransformerTransformer'</span></a></span><span> </span><span class="annot"><span class="annottext">TransformerTransformer m
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
TransformerTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asXhtmlTransformer"><span class="hs-identifier hs-var">asXhtmlTransformer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;text/plain&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TransformerTransformer m -&gt; TransformerTransformer' m
forall (m :: * -&gt; *).
TransformerTransformer m -&gt; TransformerTransformer' m
</span><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-var">TransformerTransformer'</span></a></span><span> </span><span class="annot"><span class="annottext">TransformerTransformer m
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
TransformerTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asPlainTextTransformer"><span class="hs-identifier hs-var">asPlainTextTransformer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;text/markdown&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TransformerTransformer m -&gt; TransformerTransformer' m
forall (m :: * -&gt; *).
TransformerTransformer m -&gt; TransformerTransformer' m
</span><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-var">TransformerTransformer'</span></a></span><span> </span><span class="annot"><span class="annottext">TransformerTransformer m
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
TransformerTransformer m
</span><a href="Text.Seonbi.ContentTypes.html#asCommonMarkTransformer"><span class="hs-identifier hs-var">asCommonMarkTransformer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | Supported content types.</span><span>
</span><span id="line-323"></span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#contentTypes"><span class="hs-identifier hs-type">contentTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#ContentType"><span class="hs-identifier hs-type">ContentType</span></a></span><span>
</span><span id="line-324"></span><span id="contentTypes"><span class="annot"><span class="annottext">contentTypes :: Set ContentType
</span><a href="Text.Seonbi.ContentTypes.html#contentTypes"><span class="hs-identifier hs-var hs-var">contentTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ContentType] -&gt; Set ContentType
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Data.Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([ContentType] -&gt; Set ContentType)
-&gt; ([(ContentType, TransformerTransformer' IO)] -&gt; [ContentType])
-&gt; [(ContentType, TransformerTransformer' IO)]
-&gt; Set ContentType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((ContentType, TransformerTransformer' IO) -&gt; ContentType)
-&gt; [(ContentType, TransformerTransformer' IO)] -&gt; [ContentType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">Prelude.map</span></span><span> </span><span class="annot"><span class="annottext">(ContentType, TransformerTransformer' IO) -&gt; ContentType
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ContentType, TransformerTransformer' IO)]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
[(ContentType, TransformerTransformer' m)]
</span><a href="Text.Seonbi.ContentTypes.html#transformers"><span class="hs-identifier hs-var">transformers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#ContentType"><span class="hs-identifier hs-type">ContentType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-type">TransformerTransformer'</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span id="local-6989586621679151825"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#getTransformerTransformer"><span class="hs-identifier hs-type">getTransformerTransformer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151825"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151825"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#ContentType"><span class="hs-identifier hs-type">ContentType</span></a></span><span>
</span><span id="line-329"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-type">TransformerTransformer'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151825"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-330"></span><span id="getTransformerTransformer"><span class="annot"><span class="annottext">getTransformerTransformer :: ContentType -&gt; Maybe (TransformerTransformer' m)
</span><a href="Text.Seonbi.ContentTypes.html#getTransformerTransformer"><span class="hs-identifier hs-var hs-var">getTransformerTransformer</span></a></span></span><span> </span><span id="local-6989586621679151605"><span class="annot"><span class="annottext">contentType :: ContentType
</span><a href="#local-6989586621679151605"><span class="hs-identifier hs-var">contentType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">(ContentType, TransformerTransformer' m)
-&gt; TransformerTransformer' m
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((ContentType, TransformerTransformer' m)
 -&gt; TransformerTransformer' m)
-&gt; Maybe (ContentType, TransformerTransformer' m)
-&gt; Maybe (TransformerTransformer' m)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((ContentType, TransformerTransformer' m) -&gt; Bool)
-&gt; [(ContentType, TransformerTransformer' m)]
-&gt; Maybe (ContentType, TransformerTransformer' m)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Data.List.find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ContentType -&gt; ContentType -&gt; Bool
forall a. Accept a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">matches</span></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679151605"><span class="hs-identifier hs-var">contentType</span></a></span><span> </span><span class="annot"><span class="annottext">(ContentType -&gt; Bool)
-&gt; ((ContentType, TransformerTransformer' m) -&gt; ContentType)
-&gt; (ContentType, TransformerTransformer' m)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ContentType, TransformerTransformer' m) -&gt; ContentType
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ContentType, TransformerTransformer' m)]
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
[(ContentType, TransformerTransformer' m)]
</span><a href="Text.Seonbi.ContentTypes.html#transformers"><span class="hs-identifier hs-var">transformers</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | Applies an 'HtmlTransformer' to the given text with respect to the</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- given content type.</span><span>
</span><span id="line-335"></span><span id="local-6989586621679151601"><span class="annot"><a href="Text.Seonbi.ContentTypes.html#transformWithContentType"><span class="hs-identifier hs-type">transformWithContentType</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679151601"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679151601"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#ContentType"><span class="hs-identifier hs-type">ContentType</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-comment">-- ^ A content type.  If the content type is unsupported (i.e. not in</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-comment">-- 'contentTypes'), this function fails.</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#HtmlTransformer"><span class="hs-identifier hs-type">HtmlTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679151601"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-comment">-- ^ An 'HtmlTransformer' to apply.</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LT.Text</span></span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-comment">-- ^ A input text to transform.</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679151601"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">LT.Text</span></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-comment">-- ^ A transformed text.</span></span><span>
</span><span id="line-346"></span><span id="transformWithContentType"><span class="annot"><span class="annottext">transformWithContentType :: ContentType -&gt; HtmlTransformer m -&gt; Text -&gt; m Text
</span><a href="Text.Seonbi.ContentTypes.html#transformWithContentType"><span class="hs-identifier hs-var hs-var">transformWithContentType</span></a></span></span><span> </span><span id="local-6989586621679151600"><span class="annot"><span class="annottext">contentType :: ContentType
</span><a href="#local-6989586621679151600"><span class="hs-identifier hs-var">contentType</span></a></span></span><span> </span><span id="local-6989586621679151599"><span class="annot"><span class="annottext">transformer :: HtmlTransformer m
</span><a href="#local-6989586621679151599"><span class="hs-identifier hs-var">transformer</span></a></span></span><span> </span><span id="local-6989586621679151598"><span class="annot"><span class="annottext">inputText :: Text
</span><a href="#local-6989586621679151598"><span class="hs-identifier hs-var">inputText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ContentType -&gt; Maybe (TransformerTransformer' m)
forall (m :: * -&gt; *).
(Monad m, MonadFail m) =&gt;
ContentType -&gt; Maybe (TransformerTransformer' m)
</span><a href="Text.Seonbi.ContentTypes.html#getTransformerTransformer"><span class="hs-identifier hs-var">getTransformerTransformer</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679151600"><span class="hs-identifier hs-var">contentType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m Text
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m Text) -&gt; String -&gt; m Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">ST.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; String) -&gt; Text -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-349"></span><span>            </span><span class="annot"><span class="hs-string">&quot;unknown content type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ContentType -&gt; Text
</span><a href="Text.Seonbi.ContentTypes.html#contentTypeText"><span class="hs-identifier hs-var">contentTypeText</span></a></span><span> </span><span class="annot"><span class="annottext">ContentType
</span><a href="#local-6989586621679151600"><span class="hs-identifier hs-var">contentType</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Seonbi.ContentTypes.html#TransformerTransformer%27"><span class="hs-identifier hs-type">TransformerTransformer'</span></a></span><span> </span><span id="local-6989586621679151597"><span class="annot"><span class="annottext">transformTransformer :: TransformerTransformer m
</span><a href="#local-6989586621679151597"><span class="hs-identifier hs-var">transformTransformer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><span class="annottext">TransformerTransformer m
HtmlTransformer m -&gt; Text -&gt; m Text
</span><a href="#local-6989586621679151597"><span class="hs-identifier hs-var">transformTransformer</span></a></span><span> </span><span class="annot"><span class="annottext">HtmlTransformer m
</span><a href="#local-6989586621679151599"><span class="hs-identifier hs-var">transformer</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679151598"><span class="hs-identifier hs-var">inputText</span></a></span><span>
</span><span id="line-352"></span></pre></body></html>